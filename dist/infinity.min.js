/**
 * Infinity Page Plugin v2.0.0
 * https://github.com/leuras/infinity
 *
 * Copyright (c) 2016 Fernando Pereira LibÃ³rio
 * Released under the MIT license
 *
 * Apr 06th, 2016
 */
(function(a){a.infinity=b=>{let c=!0;if(this.go=a=>(c=!1,this.settings.url=a||this.settings.url,this._search(),this),this.more=()=>(this.settings.first+=this.settings.count,this.settings.page++,this._search(),this),this._search=()=>{let b=this.settings.url.replace("{first}",this.settings.first).replace("{page}",this.settings.page).replace("{count}",this.settings.count+1);a.ajax({url:b,dataType:this.settings.dataType}).fail((a,b,c)=>{"undefined"!=typeof this.settings.error&&this.settings.error.call(this,a,b,c)}).done((b,c,d)=>{let e,f=!0;"json"===this.settings.dataType?(a.isArray(b)?e=b:a.isArray(b.data)&&(e=b.data),f=!!(e.length>this.settings.count),f&&e.pop()):"html"===this.settings.dataType&&(e=b),"undefined"!=typeof this.settings.success&&this.settings.success.call(this,e,c,d),"undefined"==typeof this.settings.done||f||this.settings.done.call(this)})},this.settings=a.extend({},{url:"",dataType:"html",auto:!1,first:0,page:1,count:10,fail:void 0,success:void 0,done:void 0},b),!0===this.settings.auto){let b=a(window);b.scroll(()=>{b.scrollTop()+b.height()===a(document).height()&&(c?this.go():this.more())})}return this}})(jQuery);